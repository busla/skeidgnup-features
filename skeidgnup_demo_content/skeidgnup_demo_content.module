<?php
/**
* @file
* Generates demo content for Skeiðgnúp.
*/

function skeidgnup_demo_content_help($path, $arg) {
  switch ($path) {
    case "admin/help#skeidgnup_demo_content":
      return '<p>' . t("Býr til efni úr Lorem ipsum texta í allar efnistípur") . '</p>';
      break;
  }
}

function add_demo_content($type = NULL, $number = NULL, $image = NULL) {
  
    $terms = array(
      
        $term1 = array(
            'name' => t('Frétt'),
            'description' => t('Flokkur fyrir fréttatengt efni'),
            'vid' => 1,

        ),
        $term2 = array(
            'name' => t('Fésið'),
            'description' => t('Færslur á fésbókina'),
            'vid' => 1,

        ),
        $term3 = array(
            'name' => t('Síða'),
            'description' => t('Síður með upplýsingum eða fræðsluefni'),
            'vid' => 1,

        ),        
    );
    
    $number_of_terms = count($terms);
    if (taxonomy_term_load(1) == FALSE) {
      foreach ($terms as $term) {
        $term = (object) $term;
        taxonomy_term_save($term);
    }
  }
    
  switch ($type) {
    case 'post':
       $logo_uri = path_to_theme() . '/' . $image;
       $body_text = drupal_ipsum_generate('icelandic', 15, DRUPAL_IPSUM_TYPE_SENTENCE, DRUPAL_IPSUM_START_ANY, TRUE);
       $file = (object) array(
         'uid' => 1,
         'uri' => $logo_uri,
         'filemime' => file_get_mimetype($logo_uri),
         'status' => 1,
         'display' => 1,
       );
       
       $file = file_copy($file, 'public://', FILE_EXISTS_REPLACE);
       
         for ($i = 1; $i <= $number; $i++) {
             $node = new stdClass();
             $node->type = $type;
             node_object_prepare($node);
             $node->comment = 1;   
             $node->title    = drupal_ipsum_generate('icelandic', 4, DRUPAL_IPSUM_TYPE_WORD, DRUPAL_IPSUM_START_ANY, FALSE);
             $node->language = LANGUAGE_NONE;
             $node->field_post_body[$node->language][0]['value']   = $body_text;
             $node->field_post_body[$node->language][0]['summary'] = text_summary($body_text);
             $node->field_post_body[$node->language][0]['format']  = 'filtered_html';
             $node->field_post_category[$node->language][]['tid'] = rand(1, $number_of_terms);
             $node->field_post_image = array(LANGUAGE_NONE => array('0' => (array)$file));

             
             if($node = node_submit($node)) { // Prepare node for saving
               node_save($node);
             }
             else
               return 'Eitthvað skrítið á seyði';
         }
        break;
    }
}

function skeidgnup_demo_content_drupal_ipsum_vocabularies() {
  return array(
    'icelandic' => array( // Your vocabulary's machine_name.
      'title' => 'Icelandic words',
      'words' => array(
        'minnum',
        'á',
        'strætóferðirnar',
        'óviðráðanlegum',
        'orsökum',
        'sveitarstjórnarfundi',
        'desember',
        'fundurinn',
        'deiliskipulags',
        'í',
        'og',
        'með',
        'saman',
        'örlítið',
        'ljósleiðarakerfis',
        'spildu',
        'landi',
        'ESA', 
        'að', 
        'þeirri', 
        'niðurstöðu', 
        'að', 
        'það',
        'væri',
        'til',
        'þess',
        'fallið',
        'auka',
        'samkeppnishæfni',
        'þessa', 
      ),
    ),
  );
}

function skeidgnup_demo_content_menu() {
  $items['skeidgnup-demo-content'] = array(
    'title' => 'Demo content',
    'description' => t('Create loads of content!'),
    'page callback' => 'skeidgnup_demo_content_makeit',
    'access callback' => TRUE,
    'access arguments' => array('administer site configuration'),
    'type' => MENU_NORMAL_ITEM,
    'menu_name' => 'navigation',
  );
  return $items;
}

function skeidgnup_demo_content_makeit() {
  //$type, $number, $image
  add_demo_content('post', 50, 'skeidgnup-logo.png');
  return 'Allt gekk eins og í sögu.. bæ :-)';
}